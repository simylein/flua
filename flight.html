<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="Flight statistics for paragliders including igc file upload" />
		<title>Flight statistics</title>
		<style>
			.font-sans {
				font-family: ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
			}
			.box-border {
				box-sizing: border-box;
			}
			.relative {
				position: relative;
			}
			.absolute {
				position: absolute;
			}
			.top-0 {
				top: 0px;
			}
			.right-0 {
				right: 0px;
			}
			.w-9 {
				width: 36px;
			}
			.w-10 {
				width: 40px;
			}
			.w-full {
				width: 100%;
			}
			.min-w-7 {
				min-width: 28px;
			}
			.max-w-screen-2xl {
				max-width: 1536px;
			}
			.h-4 {
				height: 16px;
			}
			.h-6 {
				height: 24px;
			}
			.h-8 {
				height: 32px;
			}
			.h-12 {
				height: 48px;
			}
			.h-full {
				height: 100%;
			}
			.size-2 {
				width: 8px;
				height: 8px;
			}
			.flex {
				display: flex;
			}
			.grid {
				display: grid;
			}
			.hidden {
				display: none;
			}
			.flex-1 {
				flex: 1 1 0%;
			}
			.flex-col {
				flex-direction: column;
			}
			.flex-wrap {
				flex-wrap: wrap;
			}
			.flex-col-reverse {
				flex-direction: column-reverse;
			}
			.items-center {
				align-items: center;
			}
			.justify-around {
				justify-content: space-around;
			}
			.justify-between {
				justify-content: space-between;
			}
			.gap-1 {
				gap: 4px;
			}
			.gap-2 {
				gap: 8px;
			}
			.gap-4 {
				gap: 16px;
			}
			.m-0 {
				margin: 0px;
			}
			.m-2 {
				margin: 8px;
			}
			.m-4 {
				margin: 16px;
			}
			.mt-4 {
				margin-top: 16px;
			}
			.mr-2 {
				margin-right: 8px;
			}
			.mb-1 {
				margin-bottom: 4px;
			}
			.p-0 {
				padding: 0px;
			}
			.p-1 {
				padding: 4px;
			}
			.p-2 {
				padding: 8px;
			}
			.p-4 {
				padding: 16px;
			}
			.border-0 {
				border-width: 0px;
			}
			.border-b {
				border-bottom-width: 1px;
			}
			.border-solid {
				border-style: solid;
			}
			.border-none {
				border-style: none;
			}
			.overflow-x-scroll {
				overflow-x: scroll;
			}
			.scrollbar-none {
				scrollbar-width: none;
			}
			.text-xs {
				font-size: 12px;
				line-height: 16px;
			}
			.text-base {
				font-size: 16px;
				line-height: 24px;
			}
			.text-end {
				text-align: end;
			}
			.font-normal {
				font-weight: 400;
			}
			.font-semibold {
				font-weight: 600;
			}
			.text-black {
				color: #000000;
			}
			.text-neutral-600 {
				color: #525252;
			}
			.text-blue-600 {
				color: #2563eb;
			}
			.bg-white {
				background-color: #ffffff;
			}
			.bg-neutral-100 {
				background-color: #f5f5f5;
			}
			.bg-neutral-200 {
				background-color: #e5e5e5;
			}
			.bg-red-200 {
				background-color: #fecaca;
			}
			.bg-amber-200 {
				background-color: #fde68a;
			}
			.bg-amber-400\/80 {
				background-color: #fbbf24cc;
			}
			.bg-lime-400\/80 {
				background-color: #a3e635cc;
			}
			.bg-green-200 {
				background-color: #bbf7d0;
			}
			.bg-green-400\/80 {
				background-color: #4ade80cc;
			}
			.bg-emerald-400\/80 {
				background-color: #34d399cc;
			}
			.bg-teal-400\/80 {
				background-color: #2dd4bfcc;
			}
			.bg-cyan-400\/80 {
				background-color: #22d3eecc;
			}
			.bg-sky-400\/80 {
				background-color: #38bdf8cc;
			}
			.bg-blue-200 {
				background-color: #bfdbfe;
			}
			.bg-blue-400\/80 {
				background-color: #60a5facc;
			}
			.bg-indigo-400\/80 {
				background-color: #818cf8cc;
			}
			.bg-purple-400\/80 {
				background-color: #c084fccc;
			}
			.border-neutral-300 {
				border-color: #d4d4d4;
			}
			.active\:scale-95:active {
				transform: scale(0.95);
			}
			.cursor-default {
				cursor: default;
			}
			.cursor-pointer {
				cursor: pointer;
			}
			.cursor-not-allowed {
				cursor: not-allowed;
			}
			.z-10 {
				z-index: 10;
			}
			@media (min-width: 640px) {
				.sm\:block {
					display: block;
				}
				.sm\:inline {
					display: inline;
				}
				.sm\:hidden {
					display: none;
				}
				.sm\:gap-2 {
					gap: 8px;
				}
				.sm\:mr-4 {
					margin-right: 16px;
				}
			}
			@media (min-width: 768px) {
				.md\:hidden {
					display: none;
				}
				.md\:flex-row {
					flex-direction: row;
				}
				.md\:gap-1 {
					gap: 4px;
				}
				.md\:gap-3 {
					gap: 12px;
				}
				.md\:gap-6 {
					gap: 24px;
				}
				.md\:m-4 {
					margin: 16px;
				}
				.md\:m-6 {
					margin: 24px;
				}
				.md\:mr-2 {
					margin-right: 8px;
				}
				.md\:p-1\.5 {
					padding: 6px;
				}
				.md\:p-3 {
					padding: 12px;
				}
			}
			@media (min-width: 1024px) {
				.lg\:gap-2 {
					gap: 8px;
				}
				.lg\:gap-4 {
					gap: 16px;
				}
				.lg\:gap-8 {
					gap: 32px;
				}
				.lg\:m-8 {
					margin: 32px;
				}
				.lg\:mr-4 {
					margin-right: 16px;
				}
				.lg\:p-2 {
					padding: 8px;
				}
				.lg\:p-4 {
					padding: 16px;
				}
			}
			@media (min-width: 1280px) {
				.xl\:inline {
					display: inline;
				}
				.xl\:gap-3 {
					gap: 12px;
				}
			}
			@media (prefers-color-scheme: dark) {
				.dark\:text-white {
					color: #ffffff;
				}
				.dark\:text-neutral-400 {
					color: #a3a3a3;
				}
				.dark\:text-blue-400 {
					color: #60a5fa;
				}
				.dark\:bg-black {
					background-color: #000000;
				}
				.dark\:bg-neutral-800 {
					background-color: #262626;
				}
				.dark\:bg-neutral-900 {
					background-color: #171717;
				}
				.dark\:bg-red-800 {
					background-color: #991b1b;
				}
				.dark\:bg-amber-600\/80 {
					background-color: #d97706cc;
				}
				.dark\:bg-amber-800 {
					background-color: #92400e;
				}
				.dark\:bg-lime-600\/80 {
					background-color: #65a30dcc;
				}
				.dark\:bg-green-600\/80 {
					background-color: #16a34acc;
				}
				.dark\:bg-green-800 {
					background-color: #166534;
				}
				.dark\:bg-emerald-600\/80 {
					background-color: #059669cc;
				}
				.dark\:bg-teal-600\/80 {
					background-color: #0d9488cc;
				}
				.dark\:bg-cyan-600\/80 {
					background-color: #0891b2cc;
				}
				.dark\:bg-sky-600\/80 {
					background-color: #0284c7cc;
				}
				.dark\:bg-blue-600\/80 {
					background-color: #2563ebcc;
				}
				.dark\:bg-blue-800 {
					background-color: #1e40af;
				}
				.dark\:bg-indigo-600\/80 {
					background-color: #4f46e5cc;
				}
				.dark\:bg-purple-600\/80 {
					background-color: #9333eacc;
				}
				.dark\:border-neutral-600 {
					border-color: #525252;
				}
			}
		</style>
	</head>
	<body class="font-sans flex flex-col m-0 text-black bg-white dark:text-white dark:bg-black" onload="loadYears(); loadFlights();">
		<main class="flex flex-col items-center gap-2 md:gap-3 lg:gap-4 m-4 md:m-6 lg:m-8">
			<div id="notifications" class="top-0 right-0 absolute m-2 md:m-4"></div>
			<div class="w-full max-w-screen-2xl flex gap-4 md:gap-6 lg:gap-8 justify-between">
				<div id="years" class="flex gap-2 md:gap-3 lg:gap-4 overflow-x-scroll scrollbar-none">
					<button class="p-1 md:p-1.5 lg:p-2 border-none bg-neutral-100 dark:bg-neutral-900 cursor-default">
						<p class="m-0 h-6 w-9 text-base font-normal text-black dark:text-white bg-neutral-200 dark:bg-neutral-800"></p>
					</button>
					<button class="p-1 md:p-1.5 lg:p-2 border-none bg-neutral-100 dark:bg-neutral-900 cursor-default">
						<p class="m-0 h-6 w-9 text-base font-normal text-black dark:text-white bg-neutral-200 dark:bg-neutral-800"></p>
					</button>
					<button class="p-1 md:p-1.5 lg:p-2 border-none bg-neutral-100 dark:bg-neutral-900 cursor-default">
						<p class="m-0 h-6 w-9 text-base font-normal text-black dark:text-white bg-neutral-200 dark:bg-neutral-800"></p>
					</button>
					<button class="p-1 md:p-1.5 lg:p-2 border-none bg-neutral-100 dark:bg-neutral-900 cursor-default">
						<p class="m-0 h-6 w-9 text-base font-normal text-black dark:text-white bg-neutral-200 dark:bg-neutral-800"></p>
					</button>
				</div>
				<button id="upload" class="flex items-center justify-center border-none p-0 bg-blue-200 dark:bg-blue-800 active:scale-95">
					<label for="file-upload" class="p-1 md:p-1.5 lg:p-2 text-base font-normal text-black dark:text-white cursor-pointer">Upload</label>
					<input id="file-upload" type="file" class="hidden" accept=".igc" multiple onchange="uploadFlights(event)" />
				</button>
			</div>
			<div class="w-full max-w-screen-2xl flex flex-col md:flex-row gap-2 md:gap-3 lg:gap-4">
				<div class="flex-1 p-2 md:p-3 lg:p-4 bg-neutral-100 dark:bg-neutral-900">
					<div class="flex justify-between gap-2 mb-1">
						<h2 class="m-0 text-base font-normal">Flights</h2>
						<p id="flight-count" class="w-10 h-6 m-0 text-base font-normal bg-neutral-200 dark:bg-neutral-800"></p>
					</div>
					<div style="grid-template-columns: auto 1fr; grid-template-rows: auto auto" class="grid gap-1 sm:gap-2 md:gap-1 lg:gap-2">
						<div id="flight-scale" class="flex flex-col text-xs text-end">
							<label class="min-w-7 h-4 mt-4 text-neutral-600 dark:text-neutral-400 bg-neutral-200 dark:bg-neutral-800"></label>
							<label class="min-w-7 h-4 mt-4 text-neutral-600 dark:text-neutral-400 bg-neutral-200 dark:bg-neutral-800"></label>
							<label class="min-w-7 h-4 mt-4 text-neutral-600 dark:text-neutral-400 bg-neutral-200 dark:bg-neutral-800"></label>
							<label class="min-w-7 h-4 mt-4 text-neutral-600 dark:text-neutral-400 bg-neutral-200 dark:bg-neutral-800"></label>
							<label class="min-w-7 h-4 mt-4 text-neutral-600 dark:text-neutral-400 bg-neutral-200 dark:bg-neutral-800"></label>
							<label class="min-w-7 h-4 mt-4 text-neutral-600 dark:text-neutral-400 bg-neutral-200 dark:bg-neutral-800"></label>
						</div>
						<div class="relative flex flex-col">
							<div class="absolute w-full h-full">
								<div id="flight-graph" class="flex justify-between w-full h-full gap-1 sm:gap-2 md:gap-1 lg:gap-2 xl:gap-3">
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 4%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 8%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 17%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 24%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 42%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 69%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 82%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 73%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 56%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 37%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 16%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 8%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
								</div>
							</div>
							<span class="box-border h-8 border-0 border-b border-solid border-neutral-300 dark:border-neutral-600"></span>
							<span class="box-border h-8 border-0 border-b border-solid border-neutral-300 dark:border-neutral-600"></span>
							<span class="box-border h-8 border-0 border-b border-solid border-neutral-300 dark:border-neutral-600"></span>
							<span class="box-border h-8 border-0 border-b border-solid border-neutral-300 dark:border-neutral-600"></span>
							<span class="box-border h-8 border-0 border-b border-solid border-neutral-300 dark:border-neutral-600"></span>
							<span class="box-border h-8 border-0 border-b border-solid border-neutral-300 dark:border-neutral-600"></span>
						</div>
						<div></div>
						<div class="w-full flex justify-around text-xs">
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Jan</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">J</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Feb</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">F</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Mar</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">M</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Apr</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">A</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">May</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">M</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Jun</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">J</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Jul</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">J</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Aug</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">A</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Sep</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">S</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Oct</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">O</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Nov</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">N</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Dec</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">D</label>
							</div>
						</div>
					</div>
				</div>
				<div class="flex-1 p-2 md:p-3 lg:p-4 bg-neutral-100 dark:bg-neutral-900">
					<div class="flex justify-between gap-2 mb-1">
						<h2 class="m-0 text-base font-normal">Airtime</h2>
						<p id="airtime-count" class="w-10 h-6 m-0 text-base font-normal bg-neutral-200 dark:bg-neutral-800"></p>
					</div>
					<div style="grid-template-columns: auto 1fr; grid-template-rows: auto auto" class="grid gap-1 sm:gap-2 md:gap-1 lg:gap-2">
						<div id="airtime-scale" class="flex flex-col text-xs text-end">
							<label class="min-w-7 h-4 mt-4 text-neutral-600 dark:text-neutral-400 bg-neutral-200 dark:bg-neutral-800"></label>
							<label class="min-w-7 h-4 mt-4 text-neutral-600 dark:text-neutral-400 bg-neutral-200 dark:bg-neutral-800"></label>
							<label class="min-w-7 h-4 mt-4 text-neutral-600 dark:text-neutral-400 bg-neutral-200 dark:bg-neutral-800"></label>
							<label class="min-w-7 h-4 mt-4 text-neutral-600 dark:text-neutral-400 bg-neutral-200 dark:bg-neutral-800"></label>
							<label class="min-w-7 h-4 mt-4 text-neutral-600 dark:text-neutral-400 bg-neutral-200 dark:bg-neutral-800"></label>
							<label class="min-w-7 h-4 mt-4 text-neutral-600 dark:text-neutral-400 bg-neutral-200 dark:bg-neutral-800"></label>
						</div>
						<div class="relative flex flex-col">
							<div class="absolute w-full h-full">
								<div id="airtime-graph" class="flex justify-between w-full h-full gap-1 sm:gap-2 md:gap-1 lg:gap-2 xl:gap-3">
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 4%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 8%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 17%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 24%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 42%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 69%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 82%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 73%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 56%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 37%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 16%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
									<div class="flex flex-col-reverse w-full h-full">
										<div style="height: 8%" class="bg-neutral-200 dark:bg-neutral-800"></div>
									</div>
								</div>
							</div>
							<span class="box-border h-8 border-0 border-b border-solid border-neutral-300 dark:border-neutral-600"></span>
							<span class="box-border h-8 border-0 border-b border-solid border-neutral-300 dark:border-neutral-600"></span>
							<span class="box-border h-8 border-0 border-b border-solid border-neutral-300 dark:border-neutral-600"></span>
							<span class="box-border h-8 border-0 border-b border-solid border-neutral-300 dark:border-neutral-600"></span>
							<span class="box-border h-8 border-0 border-b border-solid border-neutral-300 dark:border-neutral-600"></span>
							<span class="box-border h-8 border-0 border-b border-solid border-neutral-300 dark:border-neutral-600"></span>
						</div>
						<div></div>
						<div class="w-full flex justify-around text-xs">
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Jan</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">J</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Feb</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">F</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Mar</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">M</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Apr</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">A</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">May</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">M</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Jun</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">J</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Jul</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">J</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Aug</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">A</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Sep</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">S</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Oct</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">O</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Nov</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">N</label>
							</div>
							<div>
								<label class="hidden sm:block text-neutral-600 dark:text-neutral-400">Dec</label>
								<label class="sm:hidden text-neutral-600 dark:text-neutral-400">D</label>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="w-full max-w-screen-2xl flex flex-col md:flex-row gap-2 md:gap-3 lg:gap-4">
				<div class="flex-1 p-2 md:p-3 lg:p-4 bg-neutral-100 dark:bg-neutral-900">
					<div class="flex justify-between gap-2 mb-1">
						<h2 class="m-0 text-base font-normal">Altitude</h2>
					</div>
					<div style="grid-template-columns: 1fr; grid-template-rows: auto auto" class="grid gap-1 sm:gap-2 md:gap-1 lg:gap-2">
						<div id="altitude-scale" class="h-4 flex flex-wrap text-xs bg-neutral-200 dark:bg-neutral-800">
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-green-400/80 dark:bg-green-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400">0<span class="hidden sm:inline md:hidden xl:inline">km</span></label>
								<p class="m-0"></p>
							</div>
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-teal-400/80 dark:bg-teal-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400">1<span class="hidden sm:inline md:hidden xl:inline">km</span></label>
								<p class="m-0"></p>
							</div>
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-sky-400/80 dark:bg-sky-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400">2<span class="hidden sm:inline md:hidden xl:inline">km</span></label>
								<p class="m-0"></p>
							</div>
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-indigo-400/80 dark:bg-indigo-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400">3<span class="hidden sm:inline md:hidden xl:inline">km</span></label>
								<p class="m-0"></p>
							</div>
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-purple-400/80 dark:bg-purple-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400">4<span class="hidden sm:inline md:hidden xl:inline">km</span></label>
								<p class="m-0"></p>
							</div>
						</div>
						<div class="relative flex h-12">
							<div id="altitude-graph" class="flex w-full h-full">
								<div style="width: 12%" class="bg-neutral-200 dark:bg-neutral-800"></div>
								<div style="width: 24%" class="bg-neutral-200 dark:bg-neutral-800"></div>
								<div style="width: 40%" class="bg-neutral-200 dark:bg-neutral-800"></div>
								<div style="width: 20%" class="bg-neutral-200 dark:bg-neutral-800"></div>
								<div style="width: 4%" class="bg-neutral-200 dark:bg-neutral-800"></div>
							</div>
						</div>
					</div>
				</div>
				<div class="flex-1 p-2 md:p-3 lg:p-4 bg-neutral-100 dark:bg-neutral-900">
					<div class="flex justify-between gap-2 mb-1">
						<h2 class="m-0 text-base font-normal">Thermal</h2>
					</div>
					<div style="grid-template-columns: 1fr; grid-template-rows: auto auto" class="grid gap-1 sm:gap-2 md:gap-1 lg:gap-2">
						<div id="thermal-scale" class="h-4 flex flex-wrap text-xs bg-neutral-200 dark:bg-neutral-800">
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-amber-400/80 dark:bg-amber-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400">0<span class="hidden sm:inline md:hidden xl:inline">m/s</span></label>
								<p class="m-0"></p>
							</div>
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-lime-400/80 dark:bg-lime-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400">1<span class="hidden sm:inline md:hidden xl:inline">m/s</span></label>
								<p class="m-0"></p>
							</div>
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-emerald-400/80 dark:bg-emerald-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400">2<span class="hidden sm:inline md:hidden xl:inline">m/s</span></label>
								<p class="m-0"></p>
							</div>
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-cyan-400/80 dark:bg-cyan-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400">3<span class="hidden sm:inline md:hidden xl:inline">m/s</span></label>
								<p class="m-0"></p>
							</div>
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-blue-400/80 dark:bg-blue-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400">4<span class="hidden sm:inline md:hidden xl:inline">m/s</span></label>
								<p class="m-0"></p>
							</div>
						</div>
						<div class="relative flex h-12">
							<div id="thermal-graph" class="flex w-full h-full">
								<div style="width: 12%" class="bg-neutral-200 dark:bg-neutral-800"></div>
								<div style="width: 24%" class="bg-neutral-200 dark:bg-neutral-800"></div>
								<div style="width: 40%" class="bg-neutral-200 dark:bg-neutral-800"></div>
								<div style="width: 20%" class="bg-neutral-200 dark:bg-neutral-800"></div>
								<div style="width: 4%" class="bg-neutral-200 dark:bg-neutral-800"></div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="w-full max-w-screen-2xl flex flex-col md:flex-row gap-2 md:gap-3 lg:gap-4">
				<div class="flex-1 p-2 md:p-3 lg:p-4 bg-neutral-100 dark:bg-neutral-900">
					<div class="flex justify-between gap-2 mb-1">
						<h2 class="m-0 text-base font-normal">Speed</h2>
					</div>
					<div style="grid-template-columns: 1fr; grid-template-rows: auto auto" class="grid gap-1 sm:gap-2 md:gap-1 lg:gap-2">
						<div id="speed-scale" class="h-4 flex flex-wrap text-xs bg-neutral-200 dark:bg-neutral-800">
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-green-400/80 dark:bg-green-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400">20<span class="hidden sm:inline md:hidden xl:inline">km/h</span></label>
								<p class="m-0"></p>
							</div>
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-teal-400/80 dark:bg-teal-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400">30<span class="hidden sm:inline md:hidden xl:inline">km/h</span></label>
								<p class="m-0"></p>
							</div>
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-sky-400/80 dark:bg-sky-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400">40<span class="hidden sm:inline md:hidden xl:inline">km/h</span></label>
								<p class="m-0"></p>
							</div>
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-indigo-400/80 dark:bg-indigo-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400">50<span class="hidden sm:inline md:hidden xl:inline">km/h</span></label>
								<p class="m-0"></p>
							</div>
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-purple-400/80 dark:bg-purple-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400">60<span class="hidden sm:inline md:hidden xl:inline">km/h</span></label>
								<p class="m-0"></p>
							</div>
						</div>
						<div class="relative flex h-12">
							<div id="speed-graph" class="flex w-full h-full">
								<div style="width: 12%" class="bg-neutral-200 dark:bg-neutral-800"></div>
								<div style="width: 24%" class="bg-neutral-200 dark:bg-neutral-800"></div>
								<div style="width: 40%" class="bg-neutral-200 dark:bg-neutral-800"></div>
								<div style="width: 20%" class="bg-neutral-200 dark:bg-neutral-800"></div>
								<div style="width: 4%" class="bg-neutral-200 dark:bg-neutral-800"></div>
							</div>
						</div>
					</div>
				</div>
				<div class="flex-1 p-2 md:p-3 lg:p-4 bg-neutral-100 dark:bg-neutral-900">
					<div class="flex justify-between gap-2 mb-1">
						<h2 class="m-0 text-base font-normal">Glide</h2>
					</div>
					<div style="grid-template-columns: 1fr; grid-template-rows: auto auto" class="grid gap-1 sm:gap-2 md:gap-1 lg:gap-2">
						<div id="glide-scale" class="h-4 flex flex-wrap text-xs bg-neutral-200 dark:bg-neutral-800">
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-amber-400/80 dark:bg-amber-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400"><span class="hidden sm:inline md:hidden xl:inline">1/</span>4</label>
								<p class="m-0"></p>
							</div>
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-lime-400/80 dark:bg-lime-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400"><span class="hidden sm:inline md:hidden xl:inline">1/</span>6</label>
								<p class="m-0"></p>
							</div>
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-emerald-400/80 dark:bg-emerald-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400"><span class="hidden sm:inline md:hidden xl:inline">1/</span>8</label>
								<p class="m-0"></p>
							</div>
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-cyan-400/80 dark:bg-cyan-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400"><span class="hidden sm:inline md:hidden xl:inline">1/</span>10</label>
								<p class="m-0"></p>
							</div>
							<div class="hidden items-center gap-1 mr-2 sm:mr-4 md:mr-2 lg:mr-4">
								<span class="size-2 bg-blue-400/80 dark:bg-blue-600/80"></span>
								<label class="text-neutral-600 dark:text-neutral-400"><span class="hidden sm:inline md:hidden xl:inline">1/</span>12</label>
								<p class="m-0"></p>
							</div>
						</div>
						<div class="relative flex h-12">
							<div id="glide-graph" class="flex w-full h-full">
								<div style="width: 12%" class="bg-neutral-200 dark:bg-neutral-800"></div>
								<div style="width: 24%" class="bg-neutral-200 dark:bg-neutral-800"></div>
								<div style="width: 40%" class="bg-neutral-200 dark:bg-neutral-800"></div>
								<div style="width: 20%" class="bg-neutral-200 dark:bg-neutral-800"></div>
								<div style="width: 4%" class="bg-neutral-200 dark:bg-neutral-800"></div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</main>
	</body>
	<script>
		const verticalSkeletons = [4, 8, 17, 24, 42, 69, 82, 73, 56, 37, 16, 8];
		const horizontalSkeletons = [12, 24, 40, 20, 4];
		const years = document.getElementById('years');
		const flightCount = document.getElementById('flight-count');
		const flightScale = document.getElementById('flight-scale');
		const flightGraph = document.getElementById('flight-graph');
		const airtimeCount = document.getElementById('airtime-count');
		const airtimeScale = document.getElementById('airtime-scale');
		const airtimeGraph = document.getElementById('airtime-graph');
		const altitudeScale = document.getElementById('altitude-scale');
		const altitudeGraph = document.getElementById('altitude-graph');
		const altitudeColors = [
			['bg-green-400/80', 'dark:bg-green-600/80'],
			['bg-teal-400/80', 'dark:bg-teal-600/80'],
			['bg-sky-400/80', 'dark:bg-sky-600/80'],
			['bg-indigo-400/80', 'dark:bg-indigo-600/80'],
			['bg-purple-400/80', 'dark:bg-purple-600/80'],
		];
		const thermalScale = document.getElementById('thermal-scale');
		const thermalGraph = document.getElementById('thermal-graph');
		const thermalColors = [
			['bg-amber-400/80', 'dark:bg-amber-600/80'],
			['bg-lime-400/80', 'dark:bg-lime-600/80'],
			['bg-emerald-400/80', 'dark:bg-emerald-600/80'],
			['bg-cyan-400/80', 'dark:bg-cyan-600/80'],
			['bg-blue-400/80', 'dark:bg-blue-600/80'],
		];
		const speedScale = document.getElementById('speed-scale');
		const speedGraph = document.getElementById('speed-graph');
		const speedColors = [
			['bg-green-400/80', 'dark:bg-green-600/80'],
			['bg-teal-400/80', 'dark:bg-teal-600/80'],
			['bg-sky-400/80', 'dark:bg-sky-600/80'],
			['bg-indigo-400/80', 'dark:bg-indigo-600/80'],
			['bg-purple-400/80', 'dark:bg-purple-600/80'],
		];
		const glideScale = document.getElementById('glide-scale');
		const glideGraph = document.getElementById('glide-graph');
		const glideColors = [
			['bg-amber-400/80', 'dark:bg-amber-600/80'],
			['bg-lime-400/80', 'dark:bg-lime-600/80'],
			['bg-emerald-400/80', 'dark:bg-emerald-600/80'],
			['bg-cyan-400/80', 'dark:bg-cyan-600/80'],
			['bg-blue-400/80', 'dark:bg-blue-600/80'],
		];
		const array = (length) => {
			return Array(length)
				.fill(null)
				.map((__, ind) => ind);
		};
		const units = (amount) => {
			switch (true) {
				case amount >= 1e4:
					return `${(amount / 1e3).toFixed(1)}k`;
				case amount >= 1e3:
					return `${(amount / 1e3).toFixed(2)}k`;
				case amount >= 1e1:
					return amount.toFixed(0);
				default:
					return amount % 1 === 0 ? amount : amount.toFixed(1);
			}
		};
		const times = (seconds) => {
			switch (true) {
				case seconds >= 36000:
					return `${Math.floor(seconds / 3600)}h`;
				case seconds >= 3600:
					return `${(seconds / 3600).toFixed(1)}h`;
				case seconds >= 600:
					return `${Math.floor(seconds / 60)}m`;
				case seconds >= 60:
					return `${(seconds / 60).toFixed(1)}m`;
				default:
					return seconds % 1 === 0 ? `${seconds}s` : `${seconds.toFixed(1)}s`;
			}
		};
		const buckets = (items, max) => {
			return items.reduce(
				(accumulator, item) => {
					const month = new Date(Number(item.startsAt) * 1000).getMonth();
					accumulator[month].push(item);
					return accumulator;
				},
				array(max).map(() => [])
			);
		};
		const seconds = (item) => {
			return Number(item.endsAt - item.startsAt);
		};
		const resize = (element, length) => {
			let index = 0;
			while (element.children.length !== length) {
				const diff = element.children.length - length;
				if (diff < 0) {
					const copy = element.children[0].cloneNode(true);
					element.appendChild(copy);
				} else if (diff > 0 && element.children.length > 0) {
					element.children[element.children.length - 1].remove();
				}
				index++;
			}
		};
		const loading = (element, add, remove, text, height, width) => {
			element.classList.add(...add, 'bg-neutral-200', 'dark:bg-neutral-800');
			element.classList.remove('bg-red-200', 'dark:bg-red-800', ...remove);
			if (text !== undefined && text !== null) {
				element.innerText = text;
			}
			if (height !== undefined && height !== null) {
				element.style.height = `${height}%`;
			}
			if (width !== undefined && width !== null) {
				element.style.width = `${width}%`;
			}
		};
		const paint = (element, add, remove, text, height, width) => {
			element.classList.add(...add);
			element.classList.remove('bg-neutral-200', 'dark:bg-neutral-800', ...remove);
			if (text !== undefined && text !== null) {
				element.innerText = text;
			}
			if (height !== undefined && height !== null) {
				element.style.height = `${height}%`;
			}
			if (width !== undefined && width !== null) {
				element.style.width = `${width}%`;
			}
		};
		const error = (element) => {
			element.classList.add('bg-red-200', 'dark:bg-red-800');
			element.classList.remove('bg-neutral-200', 'dark:bg-neutral-800');
		};
		const getUser = () => {
			const user = window.location.pathname.substring(1);
			return user ?? null;
		};
		const getYear = () => {
			const year = new URLSearchParams(window.location.search).get('year');
			return +(year ?? new Date().getFullYear());
		};
		const setYear = (year) => {
			const params = new URLSearchParams(window.location.search);
			params.set('year', year);
			window.history.replaceState({}, '', `${window.location.pathname}?${params.toString()}`);
		};
		const highlightYear = (year) => {
			array(years.children.length).forEach((ind) => {
				if (+years.children[ind].children[0].innerText === year) {
					years.children[ind].children[0].classList.add('text-blue-600', 'dark:text-blue-400');
				} else {
					years.children[ind].children[0].classList.remove('text-blue-600', 'dark:text-blue-400');
				}
			});
		};
		const loadingYears = () => {
			resize(years, years.children.length);
			array(years.children.length).forEach((ind) => {
				years.children[ind].onclick = null;
				years.children[ind].classList.remove('cursor-pointer', 'cursor-not-allowed');
				years.children[ind].classList.add('cursor-default');
				loading(years.children[ind].children[0], ['w-9', 'h-6'], [], '');
			});
		};
		const paintYears = (data) => {
			resize(years, data.length);
			array(years.children.length).forEach((ind) => {
				if (data[ind].year) {
					years.children[ind].classList.remove('cursor-default');
					years.children[ind].classList.add('cursor-pointer');
					years.children[ind].children[0].classList.remove('w-9', 'h-6', 'bg-neutral-200', 'dark:bg-neutral-800');
					years.children[ind].children[0].innerText = data[ind].year;
					years.children[ind].onclick = () => {
						highlightYear(data[ind].year);
						setYear(data[ind].year);
						loadFlights();
					};
				}
			});
			highlightYear(getYear());
		};
		const errorYears = () => {
			array(years.children.length).forEach((ind) => {
				years.children[ind].classList.remove('cursor-default');
				years.children[ind].classList.add('cursor-not-allowed');
				error(years.children[ind].children[0]);
			});
		};
		const loadingFlights = () => {
			loading(flightCount, ['w-10', 'h-6'], [], '');
			array(flightScale.children.length).forEach((ind) => {
				loading(flightScale.children[ind], ['h-4'], [], '');
			});
			array(flightGraph.children.length).forEach((ind) => {
				loading(flightGraph.children[ind].children[0], [], ['bg-green-400/80', 'dark:bg-green-600/80'], null, verticalSkeletons[ind]);
			});
		};
		const paintFlights = (data) => {
			paint(flightCount, [], ['w-10', 'h-6'], units(data.length));
			const windows = buckets(data, flightGraph.children.length);
			const max = Math.max(...windows.map((window) => window.length));
			array(flightScale.children.length).forEach((ind) => {
				paint(flightScale.children[ind], [], ['h-4'], units((max / flightScale.children.length) * (5 - ind)));
			});
			windows.forEach((window, index) => {
				array(flightGraph.children[index].children.length).forEach((ind) => {
					flightGraph.children[index].children[ind].style.height = null;
				});
				const percent = (window.length / max) * 100;
				paint(flightGraph.children[index].children[0], ['bg-green-400/80', 'dark:bg-green-600/80'], [], null, percent);
			});
		};
		const errorFlights = () => {
			error(flightCount);
			array(flightScale.children.length).forEach((ind) => {
				error(flightScale.children[ind]);
			});
			array(flightGraph.children.length).forEach((ind) => {
				error(flightGraph.children[ind].children[0]);
			});
		};
		const loadingAirtime = () => {
			loading(airtimeCount, ['w-10', 'h-6'], [], '');
			array(airtimeScale.children.length).forEach((ind) => {
				loading(airtimeScale.children[ind], ['h-4'], [], '');
			});
			array(airtimeGraph.children.length).forEach((ind) => {
				loading(airtimeGraph.children[ind].children[0], [], ['bg-blue-400/80', 'dark:bg-blue-600/80'], null, verticalSkeletons[ind]);
			});
		};
		const paintAirtime = (data) => {
			paint(airtimeCount, [], ['w-10', 'h-6'], times(data.reduce((accumulator, item) => accumulator + seconds(item), 0)));
			const windows = buckets(data, airtimeGraph.children.length);
			const max = Math.max(...windows.map((window) => window.reduce((accumulator, item) => accumulator + seconds(item), 0)));
			array(airtimeScale.children.length).forEach((ind) => {
				paint(airtimeScale.children[ind], [], ['h-4'], times((max / airtimeScale.children.length) * (5 - ind)));
			});
			windows.forEach((window, index) => {
				array(airtimeGraph.children[index].children.length).forEach((ind) => {
					airtimeGraph.children[index].children[ind].style.height = null;
				});
				const percent = (window.reduce((accumulator, item) => accumulator + seconds(item), 0) / max) * 100;
				paint(airtimeGraph.children[index].children[0], ['bg-blue-400/80', 'dark:bg-blue-600/80'], [], null, percent);
			});
		};
		const errorAirtime = () => {
			error(airtimeCount);
			array(airtimeScale.children.length).forEach((ind) => {
				error(airtimeScale.children[ind]);
			});
			array(airtimeGraph.children.length).forEach((ind) => {
				error(airtimeGraph.children[ind].children[0]);
			});
		};
		const loadingAltitude = () => {
			loading(altitudeScale, ['h-4'], []);
			array(altitudeScale.children.length).forEach((ind) => {
				altitudeScale.children[ind].classList.add('hidden');
				altitudeScale.children[ind].classList.remove('flex');
			});
			array(altitudeGraph.children.length).forEach((ind) => {
				loading(altitudeGraph.children[ind], [], altitudeColors[ind], null, null, horizontalSkeletons[ind]);
			});
		};
		const paintAltitude = (data) => {
			const altitudes = data.reduce(
				(accumulator, flight) => {
					flight.altitude.forEach((altitude, ind) => (accumulator[ind] += altitude));
					return accumulator;
				},
				[0, 0, 0, 0, 0]
			);
			const max = altitudes.reduce((accumulator, altitude) => accumulator + altitude, 0);
			if (max > 0) {
				altitudeScale.classList.remove('h-4');
			}
			paint(altitudeScale, [], []);
			array(altitudeScale.children.length).forEach((ind) => {
				if (altitudes[ind] > 0) {
					paint(altitudeScale.children[ind], ['flex'], ['hidden']);
				} else {
					paint(altitudeScale.children[ind], ['hidden'], ['flex']);
				}
				altitudeScale.children[ind].children[2].innerHTML = times(altitudes[ind]);
			});
			array(altitudeGraph.children.length).forEach((ind) => {
				const percent = max === 0 ? 0 : (altitudes[ind] / max) * 100;
				paint(altitudeGraph.children[ind], altitudeColors[ind], [], null, null, percent);
			});
		};
		const errorAltitude = () => {
			error(altitudeScale);
			array(altitudeGraph.children.length).forEach((ind) => {
				error(altitudeGraph.children[ind]);
			});
		};
		const loadingThermal = () => {
			loading(thermalScale, ['h-4'], []);
			array(thermalScale.children.length).forEach((ind) => {
				thermalScale.children[ind].classList.add('hidden');
				thermalScale.children[ind].classList.remove('flex');
			});
			array(thermalGraph.children.length).forEach((ind) => {
				loading(thermalGraph.children[ind], [], thermalColors[ind], null, null, horizontalSkeletons[ind]);
			});
		};
		const paintThermal = (data) => {
			const thermals = data.reduce(
				(accumulator, flight) => {
					flight.thermal.forEach((thermal, ind) => (accumulator[ind] += thermal));
					return accumulator;
				},
				[0, 0, 0, 0, 0]
			);
			const max = thermals.reduce((accumulator, thermal) => accumulator + thermal, 0);
			if (max > 0) {
				thermalScale.classList.remove('h-4');
			}
			paint(thermalScale, [], []);
			array(thermalScale.children.length).forEach((ind) => {
				if (thermals[ind] > 0) {
					paint(thermalScale.children[ind], ['flex'], ['hidden']);
				} else {
					paint(thermalScale.children[ind], ['hidden'], ['flex']);
				}
				thermalScale.children[ind].children[2].innerHTML = times(thermals[ind]);
			});
			array(thermalGraph.children.length).forEach((ind) => {
				const percent = max === 0 ? 0 : (thermals[ind] / max) * 100;
				paint(thermalGraph.children[ind], thermalColors[ind], [], null, null, percent);
			});
		};
		const errorThermal = () => {
			error(thermalScale);
			array(thermalGraph.children.length).forEach((ind) => {
				error(thermalGraph.children[ind]);
			});
		};
		const loadingSpeed = () => {
			loading(speedScale, ['h-4'], []);
			array(speedScale.children.length).forEach((ind) => {
				speedScale.children[ind].classList.add('hidden');
				speedScale.children[ind].classList.remove('flex');
			});
			array(speedGraph.children.length).forEach((ind) => {
				loading(speedGraph.children[ind], [], speedColors[ind], null, null, horizontalSkeletons[ind]);
			});
		};
		const paintSpeed = (data) => {
			const speeds = data.reduce(
				(accumulator, flight) => {
					flight.speed.forEach((speed, ind) => (accumulator[ind] += speed));
					return accumulator;
				},
				[0, 0, 0, 0, 0]
			);
			const max = speeds.reduce((accumulator, speed) => accumulator + speed, 0);
			if (max > 0) {
				speedScale.classList.remove('h-4');
			}
			paint(speedScale, [], []);
			array(speedScale.children.length).forEach((ind) => {
				if (speeds[ind] > 0) {
					paint(speedScale.children[ind], ['flex'], ['hidden']);
				} else {
					paint(speedScale.children[ind], ['hidden'], ['flex']);
				}
				speedScale.children[ind].children[2].innerHTML = times(speeds[ind]);
			});
			array(speedGraph.children.length).forEach((ind) => {
				const percent = max === 0 ? 0 : (speeds[ind] / max) * 100;
				paint(speedGraph.children[ind], speedColors[ind], [], null, null, percent);
			});
		};
		const errorSpeed = () => {
			error(speedScale);
			array(speedGraph.children.length).forEach((ind) => {
				error(speedGraph.children[ind]);
			});
		};
		const loadingGlide = () => {
			loading(glideScale, ['h-4'], []);
			array(glideScale.children.length).forEach((ind) => {
				glideScale.children[ind].classList.add('hidden');
				glideScale.children[ind].classList.remove('flex');
			});
			array(glideGraph.children.length).forEach((ind) => {
				loading(glideGraph.children[ind], [], glideColors[ind], null, null, horizontalSkeletons[ind]);
			});
		};
		const paintGlide = (data) => {
			const glides = data.reduce(
				(accumulator, flight) => {
					flight.glide.forEach((glide, ind) => (accumulator[ind] += glide));
					return accumulator;
				},
				[0, 0, 0, 0, 0]
			);
			const max = glides.reduce((accumulator, glide) => accumulator + glide, 0);
			if (max > 0) {
				glideScale.classList.remove('h-4');
			}
			paint(glideScale, [], []);
			array(glideScale.children.length).forEach((ind) => {
				if (glides[ind] > 0) {
					paint(glideScale.children[ind], ['flex'], ['hidden']);
				} else {
					paint(glideScale.children[ind], ['hidden'], ['flex']);
				}
				glideScale.children[ind].children[2].innerHTML = times(glides[ind]);
			});
			array(glideGraph.children.length).forEach((ind) => {
				const percent = max === 0 ? 0 : (glides[ind] / max) * 100;
				paint(glideGraph.children[ind], glideColors[ind], [], null, null, percent);
			});
		};
		const errorGlide = () => {
			error(glideScale);
			array(glideGraph.children.length).forEach((ind) => {
				error(glideGraph.children[ind]);
			});
		};
		const parseYears = async (response) => {
			const buffer = await response.arrayBuffer();
			const data = new DataView(buffer);
			return array(buffer.byteLength / 2).map((ind) => {
				const year = data.getUint16(ind * 2 + 0);
				return { year };
			});
		};
		const parseFlights = async (response) => {
			const buffer = await response.arrayBuffer();
			const data = new DataView(buffer);
			let byteOffset = 0;
			let bitOffset = 0;
			const readBits = (bits) => {
				let value = 0;
				for (let index = 0; index < bits; index++) {
					const byte = data.getUint8(byteOffset);
					const bit = (byte >> (7 - bitOffset)) & 1;
					value = (value << 1) | bit;
					bitOffset++;
					if (bitOffset === 8) {
						byteOffset++;
						bitOffset = 0;
					}
				}
				return value;
			};
			const readBigBits = (bits) => {
				let value = 0n;
				for (let index = 0; index < bits; index++) {
					const byte = data.getUint8(byteOffset);
					const bit = (byte >> (7 - bitOffset)) & 1;
					value = (value << 1n) | BigInt(bit);
					bitOffset++;
					if (bitOffset === 8) {
						byteOffset++;
						bitOffset = 0;
					}
				}
				return value;
			};
			const flights = [];
			while (byteOffset < buffer.byteLength) {
				const startsAtBits = readBits(4) * 8;
				const endsAtBits = readBits(4) * 8;
				const altitudeBits = [readBits(2) * 8, readBits(2) * 8, readBits(2) * 8, readBits(2) * 8, readBits(2) * 8];
				const thermalBits = [readBits(2) * 8, readBits(2) * 8, readBits(2) * 8, readBits(2) * 8, readBits(2) * 8];
				const speedBits = [readBits(2) * 8, readBits(2) * 8, readBits(2) * 8, readBits(2) * 8, readBits(2) * 8];
				const glideBits = [readBits(2) * 8, readBits(2) * 8, readBits(2) * 8, readBits(2) * 8, readBits(2) * 8];
				const startsAt = readBigBits(startsAtBits);
				const endsAt = readBigBits(endsAtBits);
				const altitude = [readBits(altitudeBits[0]), readBits(altitudeBits[1]), readBits(altitudeBits[2]), readBits(altitudeBits[3]), readBits(altitudeBits[4])];
				const thermal = [readBits(thermalBits[0]), readBits(thermalBits[1]), readBits(thermalBits[2]), readBits(thermalBits[3]), readBits(thermalBits[4])];
				const speed = [readBits(speedBits[0]), readBits(speedBits[1]), readBits(speedBits[2]), readBits(speedBits[3]), readBits(speedBits[4])];
				const glide = [readBits(glideBits[0]), readBits(glideBits[1]), readBits(glideBits[2]), readBits(glideBits[3]), readBits(glideBits[4])];
				flights.push({ startsAt, endsAt, altitude, thermal, speed, glide });
			}
			return flights;
		};
		const loadYears = async () => {
			window.requestAnimationFrame(() => loadingYears());
			try {
				if (window.localStorage.getItem('develop')) {
					await new Promise((resolve) => setTimeout(resolve, 400 + Math.random() * 800));
					if (Math.random() < 0.1) {
						throw { status: Math.floor(Math.random() * 200) + 400, statusText: 'Develop' };
					}
				}
				const response = await fetch(`/api/year?user=${getUser()}`);
				if (response.status < 200 || response.status > 299) {
					throw Error(response);
				}
				const data = await parseYears(response);
				window.requestAnimationFrame(() => paintYears(data.length > 0 ? data : [{ year: null }]));
			} catch {
				window.requestAnimationFrame(() => errorYears());
			}
		};
		const loadFlights = async () => {
			window.requestAnimationFrame(() => loadingFlights());
			window.requestAnimationFrame(() => loadingAirtime());
			window.requestAnimationFrame(() => loadingAltitude());
			window.requestAnimationFrame(() => loadingThermal());
			window.requestAnimationFrame(() => loadingSpeed());
			window.requestAnimationFrame(() => loadingGlide());
			try {
				if (window.localStorage.getItem('develop')) {
					await new Promise((resolve) => setTimeout(resolve, 400 + Math.random() * 800));
					if (Math.random() < 0.1) {
						throw { status: Math.floor(Math.random() * 200) + 400, statusText: 'Develop' };
					}
				}
				const response = await fetch(`/api/flight?user=${getUser()}&year=${getYear()}`);
				if (response.status < 200 || response.status > 299) {
					throw Error(response);
				}
				const data = await parseFlights(response);
				window.requestAnimationFrame(() => paintFlights(data));
				window.requestAnimationFrame(() => paintAirtime(data));
				window.requestAnimationFrame(() => paintAltitude(data));
				window.requestAnimationFrame(() => paintThermal(data));
				window.requestAnimationFrame(() => paintSpeed(data));
				window.requestAnimationFrame(() => paintGlide(data));
			} catch {
				window.requestAnimationFrame(() => errorFlights());
				window.requestAnimationFrame(() => errorAirtime());
				window.requestAnimationFrame(() => errorAltitude());
				window.requestAnimationFrame(() => errorThermal());
				window.requestAnimationFrame(() => errorSpeed());
				window.requestAnimationFrame(() => errorGlide());
			}
		};
		const upload = document.getElementById('upload');
		const readFile = (file) => {
			return new Promise((resolve) => {
				const reader = new FileReader();
				reader.onload = (event) => resolve(event.target.result);
				reader.readAsText(file);
			});
		};
		const hashFile = async (content) => {
			const data = new TextEncoder().encode(content);
			const buffer = await crypto.subtle.digest('sha-256', data);
			const array = Array.from(new Uint8Array(buffer));
			const hex = array.map((byte) => byte.toString(16).padStart(2, '0'));
			return [hex.join(''), buffer];
		};
		const postFlight = async (hexHash, binHash, startsAt, endsAt, altitude, thermal, speed, glide) => {
			const buffer = new ArrayBuffer(88);
			const view = new DataView(buffer);
			const hash = new Uint8Array(binHash);
			for (let index = 0; index < 32; index++) {
				view.setUint8(index, hash[index]);
			}
			view.setBigUint64(32, startsAt);
			view.setBigUint64(40, endsAt);
			for (let index = 0; index < 5; index++) {
				view.setUint16(48 + index * 2, altitude[index]);
			}
			for (let index = 0; index < 5; index++) {
				view.setUint16(58 + index * 2, thermal[index]);
			}
			for (let index = 0; index < 5; index++) {
				view.setUint16(68 + index * 2, speed[index]);
			}
			for (let index = 0; index < 5; index++) {
				view.setUint16(78 + index * 2, glide[index]);
			}
			try {
				if (window.localStorage.getItem('develop')) {
					await new Promise((resolve) => setTimeout(resolve, 400 + Math.random() * 800));
					if (Math.random() < 0.1) {
						throw { status: Math.floor(Math.random() * 200) + 400, statusText: 'Develop' };
					}
				}
				const response = await fetch('/api/flight', { method: 'post', body: buffer, headers: { 'content-type': 'application/octet-stream' } });
				if (response.status >= 200 && response.status <= 299) {
					notification('success', `Successfully uploaded flight ${hexHash.substring(0, 8)}`);
					if (array(years.children.length).every((ind) => +years.children[ind].children[0].innerText !== new Date(Number(startsAt) * 1000).getFullYear())) {
						loadYears();
					}
					if (getYear() === new Date(Number(startsAt) * 1000).getFullYear()) {
						loadFlights();
					}
					return;
				}
				throw response;
			} catch (err) {
				if (err instanceof TypeError) {
					return notification('info', 'Seems like you might be offline');
				}
				const message = `Request failed with ${err.status ?? 0} ${err.statusText ?? null}`;
				if (err.status < 500) {
					return notification('warning', message);
				}
				return notification('error', message);
			}
		};
		const uploadFlights = async (event) => {
			const store = upload.children[0].innerText;
			upload.children[0].innerText = 'uploading...';
			upload.children[1].disabled = true;
			upload.children[0].classList.add('cursor-progress');
			upload.children[0].classList.remove('active:scale-95', 'cursor-pointer');
			const files = Array.from(event.target.files);
			for (const file of files) {
				const content = await readFile(file);
				const [hexHash, binHash] = await hashFile(content);
				const data = parseIgcFile(content);
				if (data.length < 64) {
					notification('info', `Flight ${hexHash.substring(0, 8)} is too short`);
					continue;
				}
				const startsAt = BigInt(data[0].time);
				const endsAt = BigInt(data[data.length - 1].time);
				const altitude = parseAltitude(data);
				const thermal = parseThermal(data);
				const speed = parseSpeed(data);
				const glide = parseGlide(data);
				await postFlight(hexHash, binHash, startsAt, endsAt, altitude, thermal, speed, glide);
			}
			upload.children[0].innerText = store;
			upload.children[1].disabled = false;
			upload.children[0].classList.add('active:scale-95', 'cursor-pointer');
			upload.children[0].classList.remove('cursor-progress');
		};
		const parseIgcFile = (content) => {
			const dateRegex = new RegExp(/^HFDTE([0-2][0-9]|3[0-1])(0[1-9]|1[0-2])\d{2}$/);
			const bodyRegex = new RegExp(/^B([0-1][0-9]|2[0-3])([0-5][0-9]){2}([0-8][0-9]|90)\d{5}(N|S)(0[0-9][0-9]|1[0-7][0-9]|180)\d{5}(E|W)(A|V)\d{5}\d{5}$/);
			const lines = content.split('\r\n').map((line) => line.substring(0, line.length));
			const head = lines.filter((line) => line.startsWith('HF'));
			const body = lines.filter((line) => line.startsWith('B'));
			const raw = head.find((line) => line.match(dateRegex));
			let date = null;
			if (raw) {
				date = `20${raw.substring(9, 11)}-${raw.substring(7, 9)}-${raw.substring(5, 7)}`;
			} else {
				date = '1970-01-01';
			}
			const data = [];
			for (let index = 0; index < body.length; index++) {
				const line = body[index];
				if (line.match(bodyRegex)) {
					const time = `${date}T${line.substring(1, 3)}:${line.substring(3, 5)}:${line.substring(5, 7)}Z`;
					const latDeg = +line.substring(7, 9);
					const latMin = +line.substring(9, 11);
					const latSec = +line.substring(11, 14);
					const lat = latDeg * 1000 * 60 + latMin * 1000 + latSec;
					const lonDeg = +line.substring(15, 18);
					const lonMin = +line.substring(18, 20);
					const lonSec = +line.substring(20, 23);
					const lon = lonDeg * 1000 * 60 + lonMin * 1000 + lonSec;
					const altIsa = +line.substring(25, 30);
					const altGps = +line.substring(30, 36);
					const point = {
						time: new Date(time).getTime() / 1000,
						lat: line[14] === 'S' ? -lat : lat,
						lon: line[23] === 'W' ? -lon : lon,
						altIsa,
						altGps,
					};
					data.push(point);
				}
			}
			return data;
		};
		const radians = (degrees) => {
			return (degrees * Math.PI) / 180;
		};
		const heading = (startPoint, endPoint) => {
			const scaleFactor = 1000 * 60;
			const latDiff = (endPoint.lat - startPoint.lat) / scaleFactor;
			const lonDiff = (endPoint.lon - startPoint.lon) / scaleFactor;
			const y = Math.sin(radians(lonDiff)) * Math.cos(radians(endPoint.lat / scaleFactor));
			const x =
				Math.cos(radians(startPoint.lat / scaleFactor)) * Math.sin(radians(endPoint.lat / scaleFactor)) -
				Math.sin(radians(startPoint.lat / scaleFactor)) * Math.cos(radians(endPoint.lat / scaleFactor)) * Math.cos(radians(lonDiff));
			const rawHeading = (Math.atan2(y, x) * 180) / Math.PI;
			return +((rawHeading + 360) % 360).toFixed(0);
		};
		const distance = (startPoint, endPoint) => {
			const earthRadius = 6371;
			const scaleFactor = 1000 * 60;
			const latDiff = (endPoint.lat - startPoint.lat) / scaleFactor;
			const lonDiff = (endPoint.lon - startPoint.lon) / scaleFactor;
			const a =
				Math.sin(radians(latDiff) / 2) * Math.sin(radians(latDiff) / 2) +
				Math.cos(startPoint.lat / scaleFactor) * Math.cos(endPoint.lat / scaleFactor) * Math.sin(radians(lonDiff) / 2) * Math.sin(radians(lonDiff) / 2);
			const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
			return +(earthRadius * c * 1000).toFixed(1);
		};
		const parseAltitude = (data) => {
			const categories = [0, 0, 0, 0, 0];
			for (let index = 0; index < data.length; index++) {
				const point = data[index];
				if (point.altIsa >= 0) {
					const category = Math.floor(point.altGps / 1000);
					categories[category <= 4 ? category : 4]++;
				}
			}
			return categories;
		};
		const parseThermal = (data) => {
			const categories = [0, 0, 0, 0, 0];
			const headingDiffs = [];
			for (let index = 0; index < data.length; index++) {
				const point = data[index];
				if (index + 2 < data.length) {
					headingDiffs.push(heading(point, data[index + 1]) - heading(data[index + 1], data[index + 2]));
					if (headingDiffs.length > 10) {
						headingDiffs.shift();
					}
					const headingDiff = headingDiffs.reduce((accumulator, diff) => accumulator + diff, 0);
					const altitudeDiff = data[index + 1].altIsa - point.altIsa;
					if (altitudeDiff >= 0 && Math.abs(headingDiff) >= 120) {
						const category = Math.floor(altitudeDiff);
						categories[category <= 4 ? category : 4]++;
					}
				}
			}
			return categories;
		};
		const parseSpeed = (data) => {
			const categories = [0, 0, 0, 0, 0];
			const distances = [];
			for (let index = 0; index < data.length; index++) {
				const point = data[index];
				if (index + 10 < data.length) {
					distances.push(distance(point, data[index + 1]));
					if (distances.length > 10) {
						distances.shift();
					}
					const totalDistance = distances.reduce((accumulator, distance) => accumulator + distance, 0);
					const speed = (totalDistance / 10) * 3.6;
					switch (true) {
						case speed >= 20 && speed < 30:
							categories[0]++;
							break;
						case speed >= 30 && speed < 40:
							categories[1]++;
							break;
						case speed >= 40 && speed < 50:
							categories[2]++;
							break;
						case speed >= 50 && speed < 60:
							categories[3]++;
							break;
						case speed >= 60 && speed < 70:
							categories[4]++;
							break;
					}
				}
			}
			return categories;
		};
		const parseGlide = (data) => {
			const categories = [0, 0, 0, 0, 0];
			const headingDiffs = [];
			const distances = [];
			for (let index = 0; index < data.length; index++) {
				const point = data[index];
				if (index + 10 < data.length) {
					headingDiffs.push(heading(point, data[index + 1]) - heading(data[index + 1], data[index + 2]));
					if (headingDiffs.length > 10) {
						headingDiffs.shift();
					}
					distances.push(distance(point, data[index + 1]));
					if (distances.length > 10) {
						distances.shift();
					}
					const headingDiff = headingDiffs.reduce((accumulator, diff) => accumulator + diff, 0);
					const totalDistance = distances.reduce((accumulator, distance) => accumulator + distance, 0);
					const altitudeDiff = data[index + 10].altIsa - point.altIsa;
					if (altitudeDiff <= 0 && Math.abs(headingDiff) <= 60) {
						const glideRatio = totalDistance / Math.abs(altitudeDiff);
						switch (true) {
							case glideRatio >= 4 && glideRatio < 6:
								categories[0]++;
								break;
							case glideRatio >= 6 && glideRatio < 8:
								categories[1]++;
								break;
							case glideRatio >= 8 && glideRatio < 10:
								categories[2]++;
								break;
							case glideRatio >= 10 && glideRatio < 12:
								categories[3]++;
								break;
							case glideRatio >= 12 && glideRatio < 14:
								categories[4]++;
								break;
						}
					}
				}
			}
			return categories;
		};
		const notifications = document.getElementById('notifications');
		const kind = (type) => {
			switch (type) {
				case 'info':
					return 'Info';
				case 'success':
					return 'Success';
				case 'warning':
					return 'Warning';
				case 'error':
					return 'Error';
			}
		};
		const color = (type) => {
			switch (type) {
				case 'info':
					return ['bg-blue-200', 'dark:bg-blue-800'];
				case 'success':
					return ['bg-green-200', 'dark:bg-green-800'];
				case 'warning':
					return ['bg-amber-200', 'dark:bg-amber-800'];
				case 'error':
					return ['bg-red-200', 'dark:bg-red-800'];
			}
		};
		const duration = (type) => {
			switch (type) {
				case 'info':
					return 4000;
				case 'success':
					return 3000;
				case 'warning':
					return 6000;
				case 'error':
					return 8000;
			}
		};
		const notification = (type, message) => {
			const element = document.createElement('div');
			element.classList.add('p-4', ...color(type), 'z-10');
			const head = document.createElement('h2');
			head.classList.add('m-0', 'mb-1', 'font-semibold');
			const text = document.createElement('p');
			text.classList.add('m-0', 'font-normal');
			element.appendChild(head);
			element.appendChild(text);
			element.children[0].innerText = kind(type);
			element.children[1].innerText = message;
			if (notifications.children.length > 0) {
				notifications.children[0].remove();
			}
			notifications.appendChild(element);
			setTimeout(() => element.remove(), duration(type));
		};
	</script>
</html>
